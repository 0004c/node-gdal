<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>lib/gdal.js - node-gdal</title>
    <link rel="stylesheet" href="">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="stylesheet" href="../assets/css/custom.css">
    <link rel="stylesheet" href="../assets/vendor/bootstrap/css/bootstrap.css">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
</head>
<body class="yui3-skin-sam">
<div class="navbar navbar-fixed-top">
    <div class="navbar-inner">
        <h1 class="brand" style="padding: 10px 16px 10px; height: 20px; line-height: 20px; margin-left: 0;">
        
	    <img alt="node-gdal" src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/df/GDALLogoColor.svg/200px-GDALLogoColor.svg.png" style="max-height: 65%;" title="node-gdal">
        
            node-gdal
        </h1>
	<div class="nav">
            <li class="divider-vertical"></li>
            <li>
                <p class="navbar-text">
                    API Docs for Version: <b>0.3.0</b>
                </p>
            </li>
        </div>
        <form class="navbar-form pull-right" style="line-height: 40px; height: 40px;">
            <input style="margin-top: 0;" type="text" class="search-query" placeholder="Search for classes/modules..." data-obj='["classes/gdal.Envelope", "classes/gdal.Envelope3D", "classes/gdal.Feature", "classes/gdal.FeatureDefn", "classes/gdal.Layer", "modules/gdal"]'>
        </form>
    </div>
</div>
<div class="container">
    <div class="row">
        <div class="span3">
	    <div>
    <h3>APIs</h3>
    <div id="sidebar">
        <ul id="main-nav" class="nav nav-tabs" style="margin-bottom:0;">
            <li class="active"><a href="#classes" data-toggle="tab">Classes</a></li>
            <li><a href="#modules" data-toggle="tab">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" placeholder="Type to filter APIs">
        </div>

        <div class="tab-content" style="border: 1px solid #DDD; border-top:0;">
            <div class="tab-pane active" id="classes">
                <ul id="api-classes" class="nav nav-list">
                    
                        <li><a href="../classes/gdal.Envelope.html">gdal.Envelope</a></li>
                    
                        <li><a href="../classes/gdal.Envelope3D.html">gdal.Envelope3D</a></li>
                    
                        <li><a href="../classes/gdal.Feature.html">gdal.Feature</a></li>
                    
                        <li><a href="../classes/gdal.FeatureDefn.html">gdal.FeatureDefn</a></li>
                    
                        <li><a href="../classes/gdal.Layer.html">gdal.Layer</a></li>
                    
                </ul>
            </div>

            <div class="tab-pane" id="modules">
                <ul id="api-modules" class="nav nav-list">
                    
                        <li><a href="../modules/gdal.html">gdal</a></li>
                    
                </ul>
            </div>
        </div>
    </div>
</div>

        </div>
        <div class="span9">
                <form id="options-form" class="form-inline pull-right">
        Show:
        <label for="api-show-inherited" class="checkbox">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected" class="checkbox">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private" class="checkbox">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated" class="checkbox">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </form>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <div class="page-header">
    <h1>lib/gdal.js <small>File</small></h1>
</div>

<div class="file">
    <pre class="prettyprint linenums">
/**
 * Provides a binding to libgdal.
 *
 * @module gdal
 */

var path         = require(&#x27;path&#x27;);
var pkg          = require(&#x27;../package.json&#x27;);
var binding_path = path.join(__dirname, &#x27;../&#x27;, pkg.binary.module_path);
var module_path  = path.join(binding_path, pkg.binary.module_name + &#x27;.node&#x27;);
var data_path    = path.resolve(__dirname, &#x27;../deps/libgdal/gdal/data&#x27;);

var gdal = module.exports = require(module_path);

gdal.Point.Multi      = gdal.MultiPoint;
gdal.LineString.Multi = gdal.MultiLineString;
gdal.LinearRing.Multi = gdal.MultiLineString;
gdal.Polygon.Multi    = gdal.MultiPolygon;

gdal.quiet();
gdal.config = {
	get: gdal.getConfigOption,
	set: gdal.setConfigOption
};

delete gdal.getConfigOption;
delete gdal.setConfigOption;

gdal.config.set(&#x27;GDAL_DATA&#x27;, data_path);


// --- add full OGREnvelope functionality ---

gdal.Envelope = require(&#x27;./envelope.js&#x27;);
gdal.Envelope3D = require(&#x27;./envelope_3d.js&#x27;);

var getEnvelope = gdal.Geometry.prototype.getEnvelope;
gdal.Geometry.prototype.getEnvelope = function() {
	var obj = getEnvelope.apply(this, arguments);
	return new gdal.Envelope(obj);
};

var getEnvelope3D = gdal.Geometry.prototype.getEnvelope3D;
gdal.Geometry.prototype.getEnvelope3D = function() {
	var obj = getEnvelope3D.apply(this, arguments);
	return new gdal.Envelope3D(obj);
};

var getExtent = gdal.Layer.prototype.getExtent;
gdal.Layer.prototype.getExtent = function() {
	var obj = getExtent.apply(this, arguments);
	return new gdal.Envelope(obj);
};

// --- add additional functionality to collections ---

function defaultForEach(iterator) {
	var n = this.count();
	for (var i = 0; i &lt; n; i++) {
		if (iterator(this.get(i)) === false) return;
	}
}

function defaultToArray() {
	var array = [];
	this.forEach(function(geom){
		array.push(geom);
	});
	return array;
}

gdal.DatasetBands.prototype.forEach = function(iterator){
	var n = this.count();
	for (var i = 1; i &lt;= n; i++) {
		if (iterator(this.get(i)) === false) return;
	}
};

gdal.LayerFeatures.prototype.forEach = function(iterator){
	var feature = this.first();
	while (feature) {
		if (iterator(feature) === false) return;
		feature = this.next();
	}
};

gdal.FeatureFields.prototype.forEach = function(iterator){
	var obj = this.toObject();
	var names = Object.keys(obj);
	var n = names.length;
	for (var i = 0; i &lt; n; i++) {
		var key   = names[i];
		var value = obj[key];
		if (iterator(value, key) === false) return;
	}
};

gdal.FeatureFields.prototype.toJSON = function(){
	return JSON.stringify(this.toObject());
}
gdal.Geometry.prototype.toObject = function(){
	return JSON.parse(this.toJSON());
}

gdal.LayerFields.prototype.forEach = defaultForEach;
gdal.DatasetLayers.prototype.forEach = defaultForEach;
gdal.FeatureDefnFields.prototype.forEach = defaultForEach;
gdal.PolygonRings.prototype.forEach = defaultForEach;
gdal.LineStringPoints.prototype.forEach = defaultForEach;
gdal.GeometryCollectionChildren.prototype.forEach = defaultForEach;
gdal.RasterBandOverviews.prototype.forEach = defaultForEach;
gdal.GDALDrivers.prototype.forEach = defaultForEach;

gdal.GeometryCollectionChildren.prototype.toArray = defaultToArray;
gdal.LineStringPoints.prototype.toArray = defaultToArray;
gdal.PolygonRings.prototype.toArray = defaultToArray;


// add &#x27;w&#x27; mode to gdal.open() method and also GDAL2-style driver selection
var open = gdal.open;
gdal.open = function(filename, mode, drivers, x_size, y_size, n_bands, datatype, options) {
	if (typeof drivers === &#x27;string&#x27;) {
		drivers = [drivers];
	} else if (drivers &amp;&amp; !(drivers instanceof Array)) {
		throw new Error(&#x27;driver(s) must be a string or array of strings&#x27;)
	}

	if (mode === &#x27;w&#x27;) {
		// create file with given driver
		if (!drivers) {
			throw new Error(&quot;Driver must be specified&quot;);
		}
		if (drivers.length !== 1) {
			throw new Error(&quot;Only one driver can be used to create a file&quot;);
		}
		var driver = gdal.drivers.get(drivers[0]);
		if (!driver) {
			throw new Error(&quot;Cannot find driver: &quot;+drivers[0]);
		}
		var args = Array.prototype.slice.call(arguments, 3);
		args.unshift(filename);
	 	return driver.create.apply(driver, args);
	} else {
		if (arguments.length &gt; 2) {
			// open file with driver list
			// loop through given drivers trying to open file
			var ds;
			drivers.forEach(function(driver_name, i){
				var driver = gdal.drivers.get(driver_name);
				if (!driver) {
					throw new Error(&quot;Cannot find driver: &quot;+driver_name);
				}
				try {
					ds = driver.open(filename, mode);
					return false;
				} catch (err) { }
			});

			if (!ds) throw new Error(&quot;Error opening dataset&quot;);
			return ds;

		} else {
			// call gdal.open() method normally
			return open.apply(gdal, arguments);
		}
	}
};

function fieldTypeFromValue(val) {
	var type = typeof val;
	if (type === &#x27;number&#x27;) {
		if(val % 1 === 0) return gdal.OFTInteger;
		else return gdal.OFTReal;
	} else if (type === &#x27;string&#x27;) {
		return gdal.OFTString;
	} else if (type === &#x27;boolean&#x27;) {
		return gdal.OFTInteger;
	} else if (val instanceof Date) {
		return gdal.OFTDateTime;
	} else if (val instanceof Array) {
		var sub_type = fieldTypeFromValue(val[0]);
		switch (sub_type) {
			case gdal.OFTString : return gdal.OFTStringList;
			case gdal.OFTInteger : return gdal.OFTIntegerList;
			case gdal.OFTReal : return gdal.OFTRealList;
			default : throw new Error(&quot;Array element cannot be converted into OGRFieldType&quot;);
		}
	} else if (val instanceof Buffer) {
		return gdal.OFTBinary;
	} else {
		throw new Error(&quot;Value cannot be converted into OGRFieldType&quot;);
	}
}

gdal.LayerFields.prototype.fromJSON = function(obj, approx_ok) {
	if (arguments.length &lt; 2) {
		approx_ok = false;
	}
	var field_names = Object.keys(obj);
	for (var i = 0; i &lt; field_names.length; i++) {
		var name  = field_names[i];
		var value = obj[field_names[i]];
		var type  = fieldTypeFromValue(value);
		var def   = new gdal.FieldDefn(name, type);
		this.add(def, approx_ok);
	}
};

gdal.Point.wkbType               = gdal.wkbPoint;
gdal.LineString.wkbType          = gdal.wkbLineString;
gdal.LinearRing.wkbType          = gdal.wkbLinearRing;
gdal.Polygon.wkbType             = gdal.wkbPolygon;
gdal.MultiPoint.wkbType          = gdal.wkbMultiPoint;
gdal.MultiLineString.wkbType     = gdal.wkbMultiLineString;
gdal.MultiPolygon.wkbType        = gdal.wkbMultiPolygon;
gdal.GeometryCollection.wkbType  = gdal.wkbGeometryCollection;

// enable passing geometry constructors as the geometry type
gdal.DatasetLayers.prototype.create = (function() {
	var create = gdal.DatasetLayers.prototype.create;
	return function(name, srs, geom_type, creation_options) {
		if (arguments.length &gt; 2 &amp;&amp; geom_type instanceof Function) {
			if (typeof geom_type.wkbType === &#x27;undefined&#x27;) {
				throw new Error(&#x27;Function must be a geometry constructor&#x27;);
			}
			arguments[2] = geom_type.wkbType;
		}
		return create.apply(this, arguments);
	};
})();

gdal.RasterBandPixels.prototype.read = (function() {
	var read = gdal.RasterBandPixels.prototype.read;
	return function(x, y, width, height, data, options) {
		if (!options) options = {};
		return read.apply(this, [x, y, width, height, data, options.buffer_width, options.buffer_height, options.type, options.pixel_space, options.line_space]);
	};
})();

gdal.RasterBandPixels.prototype.write = (function() {
	var write = gdal.RasterBandPixels.prototype.write;
	return function(x, y, width, height, data, options) {
		if (!options) options = {};
		return write.apply(this, [x, y, width, height, data, options.buffer_width, options.buffer_height, options.pixel_space, options.line_space]);
	};
})();
    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/jquery/jquery-1.8.2.min.js"></script>
<script src="../assets/vendor/bootstrap/js/bootstrap.js"></script>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script src="../assets/js/yuidoc-bootstrap.js"></script>
<script>prettyPrint();</script>
</body>
</html>
